import os
import mysql.connector

# Database connection details
db_config = {
    'host': 'localhost',  # Your database host
    'user': 'root',       # Your MySQL username
    'password': 'Rashmi@123',  # Your MySQL password
    'database': 'cultural_heritage'   # Your MySQL database
}

# Directory containing the images
image_dir = 'C:/Users/HP/Desktop/SEM5/DBMS/Project/static/artifacts'

# Connect to the database
conn = mysql.connector.connect(**db_config)
cursor = conn.cursor()

# Query to insert images into the cultural_artifacts_images table
insert_query = """
    INSERT INTO cultural_artifacts_images (Cul_id, Name, Image)
    VALUES (%s, %s, %s)
"""

# Dictionary mapping names to their Cul_id
artifacts = {
    1: ["Agra Fort", "Akbar's Tomb", "Fatehpur Sikri", "Itimad-ud-Daula's Tomb", "Taj Mahal"],
    2: ["Bodhi Tree", "Dungeshwari Cave Temples", "Mahabodhi Temple Complex", "Sujata Stupa", "Vajrasana (Diamond Throne)"],
    3: ["Dakshineswar Kali Temple", "Kalighat Kali Temple", "Rabindra Sadan", "Shovabazar Rajbari", "Victoria Memorial"],
    4: ["India Gate", "Jama Masjid", "Lotus Temple", "Qutub Minar", "Red Fort"],
    5: ["Hazara Rama Temple", "Lakshmi Narasimha Statue", "Lotus Mahal", "Virupaksha Temple", "Vittala Temple"],
    6: ["Brindavan Gardens", "Krishna Raja Sagara Dam (KRS Dam)", "Lalitha Mahal Palace", "Melukote Temple", "Mysore Palace", "St. Philomena's Church", "Tipu Sultan's Summer Palace"]
}

# Loop through each image in the directory
for filename in os.listdir(image_dir):
    if filename.endswith(('.jpg', '.jpeg', '.png', '.webp')):  # Include .webp format
        image_name = filename.rsplit('_', 1)[0].replace('_', ' ')  # Extract base name
        cul_id = None

        # Find the corresponding Cul_id and Name based on the image name
        for id, names in artifacts.items():
            if image_name in names:
                cul_id = id
                name = image_name
                break

        # Insert into the table if Cul_id and Name are found
        if cul_id is not None:
            image_path = f"{image_dir}/{filename}"
            try:
                cursor.execute(insert_query, (cul_id, name, filename))
                print(f"Inserted: {cul_id}, {name}, {filename}")
            except mysql.connector.Error as err:
                print(f"Error inserting {filename}: {err}")

# Commit the transaction and close the connection
conn.commit()
cursor.close()
conn.close()
